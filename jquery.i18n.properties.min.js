(function(h){function t(b){b.debug&&(f("callbackIfComplete()"),f("totalFiles: "+b.totalFiles),f("filesLoaded: "+b.filesLoaded));b.async&&b.filesLoaded===b.totalFiles&&b.callback&&b.callback()}function k(b,a){a.debug&&f("loadAndParseFiles");null!==b&&0<b.length?u(b[0],a,function(){b.shift();k(b,a)}):t(a)}function u(b,a,m){a.debug&&(f("loadAndParseFile('"+b+"')"),f("totalFiles: "+a.totalFiles),f("filesLoaded: "+a.filesLoaded));null!==b&&"undefined"!==typeof b&&h.ajax({url:b,async:a.async,cache:a.cache,
dataType:"text",success:function(c,e){a.debug&&(f("Succeeded in downloading "+b+"."),f(c));v(c,a);m()},error:function(c,e,d){a.debug&&f("Failed to download or parse "+b+". errorThrown: "+d);404===c.status&&--a.totalFiles;m()}})}function v(b,a){var m="",c=b.split(/\n/),e=/(\{\d+})/g,d=/\{(\d+)}/g,f=/(\\u.{4})/ig;c.forEach(function(b,w){b=b.trim();if(0<b.length&&"#"!=b.match("^#")){var l=b.split("=");if(0<l.length){for(var n=decodeURI(l[0]).trim(),g=1==l.length?"":l[1];"\\"===g.match(/\\$/);)g=g.substring(0,
g.length-1),g+=c[++w].trimRight();for(var p=2;p<l.length;p++)g+="="+l[p];g=g.trim();if("map"==a.mode||"both"==a.mode)(l=g.match(f))&&l.forEach(function(a){g=g.replace(a,x(a))}),h.i18n.map[n]=g;if("vars"==a.mode||"both"==a.mode)if(g=g.replace(/"/g,'\\"'),y(n),e.test(g)){var k=!0,q="",r=[];g.split(e).forEach(function(a){!e.test(a)||0!==r.length&&-1!=r.indexOf(a)||(k||(q+=","),q+=a.replace(d,"v$1"),r.push(a),k=!1)});m+=n+"=function("+q+"){";n='"'+g.replace(d,'"+v$1+"')+'"';m+="return "+n+";};"}else m+=
n+'="'+g+'";'}}});eval(m);a.filesLoaded+=1}function y(b){if(/\./.test(b)){var a="";b.split(/\./).forEach(function(b,c){0<c&&(a+=".");a+=b;eval("typeof "+a+' == "undefined"')&&eval(a+"={};")})}}function x(b){var a=[];b=parseInt(b.substr(2),16);0<=b&&b<Math.pow(2,16)&&a.push(b);return a.reduce(function(a,b){return a+String.fromCharCode(b)},"")}h.i18n={};h.i18n.map={};var f=function(b){window.console&&console.log("i18n::"+b)};h.i18n.properties=function(b){b=h.extend({name:"Messages",language:"",lang_default:"",
path:"",mode:"vars",cache:!1,debug:!1,encoding:"UTF-8",async:!1,callback:null},b);b.path.match(/\/$/)||(b.path+="/");b.language=this.normaliseLanguageCode(b.language);var a=b.name&&b.name.constructor===Array?b.name:[b.name];b.totalFiles=2*a.length+(5<=b.language.length?a.length:0);b.debug&&f("totalFiles: "+b.totalFiles);b.filesLoaded=0;a.forEach(function(a){var c=b.path+a+".properties";var e=b.language.substring(0,2);var d=b.path+a+"_"+e+".properties";if(5<=b.language.length){var f=b.language.substring(0,
5);a=b.path+a+"_"+f+".properties";b.lang_default!=e&&b.lang_default!=f?c=[c,d,a]:(c=b.lang_default==e?[c,a]:[c,d],--b.totalFiles)}else b.lang_default==e?(c=[c],--b.totalFiles):c=[c,d];k(c,b)});b.callback&&!b.async&&b.callback()};h.i18n.prop=function(b){var a=h.i18n.map[b];if(null===a)return"["+b+"]";var f;2==arguments.length&&h.isArray(arguments[1])&&(f=arguments[1]);var c;if("string"==typeof a){for(c=0;-1!=(c=a.indexOf("\\",c));)a="t"==a.charAt(c+1)?a.substring(0,c)+"\t"+a.substring(c++ +2):"r"==
a.charAt(c+1)?a.substring(0,c)+"\r"+a.substring(c++ +2):"n"==a.charAt(c+1)?a.substring(0,c)+"\n"+a.substring(c++ +2):"f"==a.charAt(c+1)?a.substring(0,c)+"\f"+a.substring(c++ +2):"\\"==a.charAt(c+1)?a.substring(0,c)+"\\"+a.substring(c++ +2):a.substring(0,c)+a.substring(c+1);var e=[],d;for(c=0;c<a.length;)if("'"==a.charAt(c))if(c==a.length-1)a=a.substring(0,c);else if("'"==a.charAt(c+1))a=a.substring(0,c)+a.substring(++c);else{for(d=c+2;-1!=(d=a.indexOf("'",d));)if(d==a.length-1||"'"!=a.charAt(d+1)){a=
a.substring(0,c)+a.substring(c+1,d)+a.substring(d+1);c=d-1;break}else a=a.substring(0,d)+a.substring(++d);-1==d&&(a=a.substring(0,c)+a.substring(c+1))}else if("{"==a.charAt(c))if(d=a.indexOf("}",c+1),-1==d)c++;else{var k=parseInt(a.substring(c+1,d));!isNaN(k)&&0<=k?(c=a.substring(0,c),""!==c&&e.push(c),e.push(k),c=0,a=a.substring(d+1)):c=d+1}else c++;""!==a&&e.push(a);a=e;h.i18n.map[b]=e}if(0===a.length)return"";if(1==a.length&&"string"==typeof a[0])return a[0];e="";c=0;for(d=a.length;c<d;c++)e="string"==
typeof a[c]?e+a[c]:f&&a[c]<f.length?e+f[a[c]]:!f&&a[c]+1<arguments.length?e+arguments[a[c]+1]:e+("{"+a[c]+"}");return e};h.i18n.normaliseLanguageCode=function(b){if(!b||2>b.length)b=navigator.languages&&0<navigator.languages.length?navigator.languages[0]:navigator.language||navigator.userLanguage||"en";b=b.toLowerCase();b=b.replace(/-/,"_");3<b.length&&(b=b.substring(0,3)+b.substring(3).toUpperCase());return b}})(jQuery);
